{
  "version": 3,
  "file": "main.js",
  "sourceRoot": "",
  "sources": [
    "main.coffee"
  ],
  "names": [],
  "mappings": "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",
  "sourcesContent": [
    "# Extend Caman with custom colorchanging plugin\r\nCaman.Filter.register 'translate', (fromRGB, toRGB) ->\r\n\tfromRGB = tinycolorArray(fromRGB)\tunless Array.isArray(fromRGB)\r\n\ttoRGB = tinycolorArray(toRGB)\tunless Array.isArray(toRGB)\r\n\tfrom = colorConvert.rgb2labRaw(fromRGB)\r\n\tto = colorConvert.rgb2labRaw(toRGB)\r\n\t@process 'translate', (colorRGB) ->\r\n\t\tcolor = colorConvert.rgb2labRaw([\r\n\t\t\tcolorRGB.r\r\n\t\t\tcolorRGB.g\r\n\t\t\tcolorRGB.b\r\n\t\t])\r\n\t\tcolor[0] = Math.max(0, color[0] + to[0] - from[0])\r\n\t\tcolor[1] = color[1] + to[1] - from[1]\r\n\t\tcolor[2] = color[2] + to[2] - from[2]\r\n\r\n\t\tRGB = colorConvert.lab2rgbRaw(color)\r\n\t\tcolorRGB.r = RGB[0]\r\n\t\tcolorRGB.g = RGB[1]\r\n\t\tcolorRGB.b = RGB[2]\r\n\t\tcolorRGB\r\n\r\ndistanceBetweenColors = (A, B) ->\r\n\tcolorA = tinycolor(A).toRgb()\r\n\tALab = colorConvert.rgb2labRaw([\r\n\t\tcolorA.r\r\n\t\tcolorA.g\r\n\t\tcolorA.b\r\n\t])\r\n\tcolorB = tinycolor(B).toRgb()\r\n\tBLab = colorConvert.rgb2labRaw([\r\n\t\tcolorB.r\r\n\t\tcolorB.g\r\n\t\tcolorB.b\r\n\t])\r\n\tldiff = (ALab[0] - BLab[0]) * 2\r\n\tadiff = ALab[1] - BLab[1]\r\n\tbdiff = ALab[2] - BLab[2]\r\n\r\n\tdistance = Math.sqrt(ldiff * ldiff + adiff * adiff + bdiff * bdiff)\r\n\r\nnearestColor = (color) ->\r\n\tbase = tinycolor(color)\r\n\treturn null unless base._format\r\n\tnearestDistance = Infinity\r\n\tnearest = null\r\n\tObject.keys(tinycolor.names).forEach (colorname) ->\r\n\t\tdistance = distanceBetweenColors(color, colorname)\r\n\t\tif distance < nearestDistance\r\n\t\t\tnearestDistance = distance\r\n\t\t\tnearest = colorname\r\n\t\treturn\r\n\r\n\t{\r\n\t\tname: nearest\r\n\t\tdistance: nearestDistance\r\n\t\tcolor: tinycolor(nearest)\r\n\t}\r\n\r\n# Returns score from 0.0 to 1.0\r\ncolorScore = (colorA, colorB) ->\r\n\t# currently uses evaluation by Gaussian function\r\n\tSIGMA = 30 # How much score will be lowered with distance aparted from correct color\r\n\tTOLERANCE = 0.02 # How the score will be tolerated to get full score\r\n\tdistance = distanceBetweenColors(colorA, colorB)\r\n\r\n\tscore = Math.min(Math.exp(-(distance / SIGMA) * (distance / SIGMA)) * (1 + TOLERANCE), 1)\r\n\r\n# Returns score from 0 to 100\r\ncolorScoreInt = (colorA, colorB) ->\r\n\tMath.floor colorScore(colorA, colorB) * 100\r\n\r\n# get x coordinary from touch or click event\r\ngetX = (event) ->\r\n\tif event.originalEvent.changedTouches\r\n\t\tevent.originalEvent.changedTouches[0].pageX\r\n\telse\r\n\t\tevent.originalEvent.pageX\r\n\r\npercentageToRealValue = (colorset, parameter, value) ->\r\n\t{\r\n\t\tRGB: {\r\n\t\t\tr: value * 255,\r\n\t\t\tg: value * 255,\r\n\t\t\tb: value * 255\r\n\t\t},\r\n\t\tHSV: {\r\n\t\t\th: value * 360,\r\n\t\t\ts: value * 100,\r\n\t\t\tv: value * 100\r\n\t\t},\r\n\t\tLab: {\r\n\t\t\tl: value * 100,\r\n\t\t\ta: value * 200 - 100,\r\n\t\t\tb: value * 200 - 100\r\n\t\t}\r\n\t}[colorset][parameter]\r\n\r\ncolorsetToRealValueArray = (colorset, values) ->\r\n\tparameters = {\r\n\t\tRGB: ['r', 'g', 'b'],\r\n\t\tHSV: ['h', 's', 'v'],\r\n\t\tLab: ['l', 'a', 'b']\r\n\t}[colorset]\r\n\r\n\tret = []\r\n\tparameters.forEach (parameter) ->\r\n\t\tret.push percentageToRealValue(colorset, parameter, values[parameter])\r\n\t\treturn\r\n\tret\r\n\r\nrealValueToPercentage = (colorset, parameter, value) ->\r\n\t{\r\n\t\tRGB: {\r\n\t\t\tr: value / 255,\r\n\t\t\tg: value / 255,\r\n\t\t\tb: value / 255\r\n\t\t},\r\n\t\tHSV: {\r\n\t\t\th: value / 360,\r\n\t\t\ts: value / 100,\r\n\t\t\tv: value / 100\r\n\t\t},\r\n\t\tLab: {\r\n\t\t\tl: value / 100,\r\n\t\t\ta: (value + 100) / 200,\r\n\t\t\tb: (value + 100) / 200\r\n\t\t}\r\n\t}[colorset][parameter]\r\n\r\nrealValueArrayToColorset = (colorset, values) ->\r\n\tparameters = {\r\n\t\tRGB: ['r', 'g', 'b'],\r\n\t\tHSV: ['h', 's', 'v'],\r\n\t\tLab: ['l', 'a', 'b']\r\n\t}[colorset]\r\n\r\n\tret = {}\r\n\ti = 0\r\n\tparameters.forEach (parameter) ->\r\n\t\tret[parameter] = realValueToPercentage(colorset, parameter, values[i])\r\n\t\ti++\r\n\t\treturn\r\n\tret\r\n\r\n# preserve size of image\r\ntinycolorArray = (input) ->\r\n\tRGB = tinycolor(input).toRgb()\r\n\t[RGB.r, RGB.g, RGB.b]\r\n\r\nclass Question\r\n\tconstructor: (@game, @character) ->\r\n\t\t@info = @game.queue.getResult(\"#{@character}.info\")\r\n\t\t@defaultColor = tinycolor(@info['default'])\r\n\t\t@originalColor = tinycolor(@info.color)\r\n\r\n\t\t@baseImage = @game.queue.getResult(\"#{@character}.base\")\r\n\t\t@colorImage = @game.queue.getResult(\"#{@character}.color\")\r\n\r\n\t\t@questionIndex = @game.questionIndex\r\n\r\n\t\t@colorsets =\r\n\t\t\tRGB: ['r', 'g', 'b']\r\n\t\t\tHSV: ['h', 's', 'v']\r\n\t\t\tLab: ['l', 'a', 'b']\r\n\r\n\t\t@currentImageColor =\r\n\t\t\tr: null\r\n\t\t\tg: null\r\n\t\t\tb: null\r\n\r\n\t\t@yourColor =\r\n\t\t\tr: null\r\n\t\t\tg: null\r\n\t\t\tb: null\r\n\r\n\t\t@currentSliderColor =\r\n\t\t\tRGB:\r\n\t\t\t\tr: 0\r\n\t\t\t\tg: 0\r\n\t\t\t\tb: 0\r\n\t\t\tHSV:\r\n\t\t\t\th: 0\r\n\t\t\t\ts: 0\r\n\t\t\t\tv: 0\r\n\t\t\tLab:\r\n\t\t\t\tl: 0\r\n\t\t\t\ta: 0\r\n\t\t\t\tb: 0\r\n\r\n\t\t@busy = true\r\n\t\t@caman = null\r\n\t\t@phase = 'slider'\r\n\t\t@score = null\r\n\r\n\t\t@game.selectTab 'RGB'\r\n\t\t@selectedColorset = 'RGB'\r\n\r\n\t\t@currentSliderColor.RGB = @defaultColor.toRgbPercentage()\r\n\r\n\t\t@updateSliders 'RGB'\r\n\r\n\t\t$('#original-color-preview').css 'background-color': @originalColor.toHexString()\r\n\t\t$('#original-color-info .result-color-value').text @originalColor.toHexString()\r\n\t\t$('#original-color-info .result-color-name').text nearestColor(@originalColor).name\r\n\r\n\t\t# construct image field\r\n\t\t$('#image-field').prepend [\r\n\t\t\t@imageElement = $('<div>', id: 'image').append([\r\n\t\t\t\t$('<canvas>').attr(\r\n\t\t\t\t\tid: 'canvas',\r\n\t\t\t\t\twidth: @baseImage.originalWidth,\r\n\t\t\t\t\theight: @baseImage.originalHeight\r\n\t\t\t\t),\r\n\t\t\t\t@baseImage\r\n\t\t\t]).invisible()\r\n\t\t]\r\n\r\n\t\t# update image information\r\n\t\t$('#image-info').empty().append [\r\n\t\t\t$('<span>',\r\n\t\t\t\tclass: 'text-en',\r\n\t\t\t\tlang: 'en',\r\n\t\t\t\ttext: \"#{@info.name.en}(#{@info.group.en})\"\r\n\t\t\t),\r\n\t\t\t$('<span>',\r\n\t\t\t\tclass: 'text-ja',\r\n\t\t\t\tlang: 'ja',\r\n\t\t\t\ttext: \"#{@info.name.ja}(#{@info.group.ja})\"\r\n\t\t\t),\r\n\t\t\tdocument.createTextNode(' - '),\r\n\t\t\t$('<a>',\r\n\t\t\t\thref: @info.source,\r\n\t\t\t\ttarget: '_blank',\r\n\t\t\t\ttext: 'Color Source'\r\n\t\t\t)\r\n\t\t]\r\n\r\n\t\t@caman = Caman('#canvas', 'img/' + @character + '/color.png', =>\r\n\t\t\t@busy = false\r\n\t\t\t@updateImage()\r\n\t\t)\r\n\r\n\t\t$('#color-sliders').fadeIn()\r\n\r\n\t# Update current slider color parameters based on specific colorset parameters\r\n\tupdateSliders: (base) ->\r\n\t\tbaseColor = colorsetToRealValueArray base, @currentSliderColor[base]\r\n\t\tObject.keys(@colorsets).forEach (colorset) =>\r\n\t\t\tif colorset isnt base\r\n\t\t\t\tcolor = colorConvert[base.toLowerCase()][colorset.toLowerCase()](baseColor)\r\n\t\t\t\t@currentSliderColor[colorset] = realValueArrayToColorset(colorset, color)\r\n\t\t\t@colorsets[colorset].forEach (parameter) =>\r\n\t\t\t\t@game.moveSlider colorset, parameter, @currentSliderColor[colorset][parameter]\r\n\r\n\t\t@updateInfo()\r\n\r\n\t# update displayed color information based on current color parameter\r\n\tupdateInfo: ->\r\n\t\tcolor = tinycolor.fromRatio(@currentSliderColor.RGB)\r\n\t\t$('.color-preview-value').text color.toHexString()\r\n\t\t$('.color-preview-square').css 'background-color', color.toHexString()\r\n\t\tif @phase is 'slider'\r\n\t\t\t@yourColor = $.extend {}, @currentSliderColor.RGB\r\n\r\n\t\t# update sliders gradients\r\n\t\tObject.keys(@colorsets).forEach (colorset) =>\r\n\t\t\tsliderColor = @currentSliderColor[colorset]\r\n\t\t\t@colorsets[colorset].forEach (parameter) =>\r\n\t\t\t\t$parameter = $('.color-parameter-wrap[data-colorset=' + colorset + '][data-parameter=' + parameter + ']')\r\n\t\t\t\t$slider = $parameter.find('.color-slider-wrapper')\r\n\t\t\t\tcolorStop = null\r\n\t\t\t\tcolorStops = []\r\n\t\t\t\ti = 0\r\n\r\n\t\t\t\twhile i < 7\r\n\t\t\t\t\tcolor = $.extend {}, sliderColor\r\n\t\t\t\t\tcolor[parameter] = 1 / 6 * i\r\n\t\t\t\t\tcolorArray = colorsetToRealValueArray colorset, color\r\n\t\t\t\t\tif colorset is 'RGB'\r\n\t\t\t\t\t\tcolorStop = colorArray\r\n\t\t\t\t\telse\r\n\t\t\t\t\t\tcolorStop = colorConvert[colorset.toLowerCase()].rgb(colorArray)\r\n\t\t\t\t\tcolorStops.push\r\n\t\t\t\t\t\tr: colorStop[0]\r\n\t\t\t\t\t\tg: colorStop[1]\r\n\t\t\t\t\t\tb: colorStop[2]\r\n\t\t\t\t\ti++\r\n\r\n\t\t\t\t$slider.gradient colorStops\r\n\r\n\t# update image based on current slider color\r\n\tupdateImage: ->\r\n\t\treturn if @busy\r\n\t\treturn if @currentImageColor.r is @currentSliderColor.RGB.r and @currentImageColor.g is @currentSliderColor.RGB.g and @currentImageColor.b is @currentSliderColor.RGB.b\r\n\t\t@busy = true\r\n\t\t@currentImageColor = $.extend({}, @currentSliderColor.RGB)\r\n\t\t$('#rendering').visible()\r\n\t\t@caman.revert false\r\n\t\t@caman.translate @info.color, colorsetToRealValueArray('RGB', @currentSliderColor.RGB)\r\n\t\t@caman.render =>\r\n\t\t\tif @imageElement.css('visibility') is 'hidden'\r\n\t\t\t\t@imageElement.visible().hide().fadeIn()\r\n\t\t\t$('#rendering').invisible()\r\n\t\t\t@busy = false\r\n\t\t\t@updateImage()\r\n\r\n\t# submit result and confirm OK\r\n\tsubmitResult: ->\r\n\t\tcolor = tinycolor.fromRatio @currentSliderColor.RGB\r\n\t\t$('#your-color-preview').css 'background-color': color.toHexString()\r\n\t\t$('#your-color-info .result-color-value').text color.toHexString()\r\n\t\t$('#your-color-info .result-color-name').text nearestColor(color).name\r\n\t\t@score = colorScoreInt(color, @originalColor)\r\n\t\t$('#color-sliders').fadeOut =>\r\n\t\t\t$(score: 0).animate {score: @score},\r\n\t\t\t\tstep: (currentScore) =>\r\n\t\t\t\t\tscoreInt = Math.floor(currentScore)\r\n\t\t\t\t\t$('#score-numeral').text scoreInt\r\n\t\t\t\t\t$('#score-bar-inner').css width: scoreInt + '%'\r\n\t\t\t\tduration: @score * 30\r\n\t\t\t\teasing: 'linear'\r\n\t\t\t$('#result-field').fadeIn()\r\n\r\n\t\t@phase = 'result'\r\n\r\n\t# set color by tinycolor input\r\n\tsetColor: (input) ->\r\n\t\tcolor = tinycolor input\r\n\t\tif color._format\r\n\t\t\trgb = color.toRgb()\r\n\t\t\t@currentSliderColor.RGB =\r\n\t\t\t\tr: rgb.r / 255\r\n\t\t\t\tg: rgb.g / 255\r\n\t\t\t\tb: rgb.b / 255\r\n\t\t\t@updateSliders 'RGB'\r\n\t\t\t@updateImage()\r\n\t\telse\r\n\t\t\t@updateInfo()\r\n\r\n\t# preview colors in image on result page\r\n\tpreviewResult: (isYourColor) ->\r\n\t\tif isYourColor\r\n\t\t\t@currentSliderColor.RGB = $.extend {}, @yourColor\r\n\t\telse\r\n\t\t\trgb = @originalColor.toRgb()\r\n\t\t\t@currentSliderColor.RGB =\r\n\t\t\t\tr: rgb.r / 255\r\n\t\t\t\tg: rgb.g / 255\r\n\t\t\t\tb: rgb.b / 255\r\n\t\t@updateSliders 'RGB'\r\n\t\t@updateImage()\r\n\r\n\t# quit problem\r\n\tquit: (callback) ->\r\n\t\t$('#result-field').fadeOut callback\r\n\t\t@imageElement.fadeOut =>\r\n\t\t\t@imageElement.remove()\r\n\r\nclass Game\r\n\tconstructor: ->\r\n\t\t@availableCharacters = ['akapuyo', 'harusaki-chiwa', 'ibaraki-kasen', 'neptune', 'takanashi-rikka', 'kirima-syaro', 'kafuu-chino', 'hana-fonteinsutando', 'kasumigaoka-utaha', 'akaza-akari']\r\n\t\t@questionIndex = 0\r\n\r\n\t\tif typeof localStorage.seenCharacters is 'string'\r\n\t\t\t@seenCharacters = JSON.parse(localStorage.seenCharacters)\r\n\t\telse\r\n\t\t\t@seenCharacters = []\r\n\r\n\t\t# Select characters for this session\r\n\t\t@characters = []\r\n\r\n\t\tselectableCharacters = []\r\n\t\t@availableCharacters.forEach (character) =>\r\n\t\t\tif @seenCharacters.indexOf character is -1\r\n\t\t\t\tselectableCharacters.push character\r\n\r\n\t\tshuffle selectableCharacters\r\n\t\tshuffle @seenCharacters\r\n\r\n\t\tfor i in [0 .. (Math.min(selectableCharacters.length, 5) - 1)]\r\n\t\t\t@characters.push selectableCharacters[i]\r\n\r\n\t\ti = 0\r\n\t\twhile i < 5 - @characters.length\r\n\t\t\t@characters.push @seenCharacters[i]\r\n\t\t\ti++\r\n\r\n\t\t# PreLoad Images\r\n\t\t@queue = new createjs.LoadQueue()\r\n\t\tmanifest = []\r\n\r\n\t\t@characters.forEach (character) ->\r\n\t\t\tmanifest.push\r\n\t\t\t\tid: character + '.base'\r\n\t\t\t\tsrc: 'img/' + character + '/base.png'\r\n\t\t\t,\r\n\t\t\t\tid: character + '.color'\r\n\t\t\t\tsrc: 'img/' + character + '/color.png'\r\n\t\t\t,\r\n\t\t\t\tid: character + '.info'\r\n\t\t\t\tsrc: 'img/' + character + '/info.json'\r\n\r\n\t\t@queue.on 'fileload', (event) ->\r\n\t\t\tif event.item.type is 'image'\r\n\t\t\t\tevent.result.originalWidth = event.result.width\r\n\t\t\t\tevent.result.originalHeight = event.result.height\r\n\r\n\t\t@queue.on 'progress', (event) ->\r\n\t\t\t$('#loading-background').stop(true).animate {\r\n\t\t\t\theight: event.progress * 100 + '%'\r\n\t\t\t}, 500, 'easeOutExpo'\r\n\r\n\t\t@queue.on 'complete', =>\r\n\t\t\t$(document).ready =>\r\n\t\t\t\t$('#loading-background').stop true, true\r\n\t\t\t\t$('#loading').animate {top: '-100%'}, ->\r\n\t\t\t\t\t$(@).hide()\r\n\t\t\t\t@init()\r\n\r\n\t\t@queue.loadManifest manifest\r\n\r\n\tinit: ->\r\n\t\t@currentQuestion = new Question @, @characters[0]\r\n\r\n\t\t# fire onResize event\r\n\t\t$(window).resize @onResize.bind(@)\r\n\t\t@onResize()\r\n\r\n\t\t# DOM binders\r\n\r\n\t\t$('.color-parameter').on 'touchstart mousedown', (event) =>\r\n\t\t\tevent.preventDefault()\r\n\t\t\ttouchX = getX(event)\r\n\t\t\tparameter = $(event.currentTarget).data('parameter')\r\n\t\t\toffset = $(event.currentTarget).offset().left\r\n\t\t\twidth = $(event.currentTarget).width()\r\n\t\t\tcolorset = $(event.currentTarget).data('colorset')\r\n\r\n\t\t\tmovePinch = (event) =>\r\n\t\t\t\ttouchX = getX(event)\r\n\t\t\t\tvalue = (touchX - offset) / width\r\n\t\t\t\tvalue = Math.max(0, Math.min(value, 1))\r\n\t\t\t\t@currentQuestion.currentSliderColor[colorset][parameter] = value\r\n\t\t\t\t@currentQuestion.updateSliders colorset\r\n\t\t\t\t@currentQuestion.updateImage()\r\n\r\n\t\t\t$(window).on 'touchmove mousemove', movePinch\r\n\t\t\t$(window).on 'touchend mouseup', (event) ->\r\n\t\t\t\t$(event.currentTarget).off 'touchmove mousemove', movePinch\r\n\r\n\t\t\tmovePinch event\r\n\r\n\t\t$('.color-preview-value').on 'click', (event) =>\r\n\t\t\t$(event.currentTarget).attr 'contenteditable', true\r\n\t\t\t$(event.currentTarget).selectText()\r\n\t\t\t# blur if enter is pressed\r\n\t\t\t$(event.currentTarget).on 'keypress', (event) =>\r\n\t\t\t\tif event.which is 13\r\n\t\t\t\t\t$(event.currentTarget).blur()\r\n\t\t\t\t\tfalse\r\n\t\t\t\telse\r\n\t\t\t\t\ttrue\r\n\r\n\t\t\t$(event.currentTarget).on 'blur', (event) =>\r\n\t\t\t\t$(event.currentTarget).attr 'contenteditable', false\r\n\t\t\t\t$(event.currentTarget).off 'keypress blur'\r\n\t\t\t\t@currentQuestion.setColor $(event.currentTarget).text()\r\n\r\n\t\t$('.tab-inner').on 'click', (event) =>\r\n\t\t\tif @currentQuestion.phase is 'slider'\r\n\t\t\t\t@selectTab($(event.currentTarget).text())\r\n\r\n\t\t$('.submit').on 'click', =>\r\n\t\t\t@currentQuestion.submitResult()\r\n\r\n\t\t$('#your-color-preview').on 'click', =>\r\n\t\t\t@currentQuestion.previewResult true\r\n\r\n\t\t$('#original-color-preview').on 'click', =>\r\n\t\t\t@currentQuestion.previewResult false\r\n\r\n\t\t$('.go-next').on 'click', =>\r\n\t\t\t@goNext()\r\n\r\n\tonResize: (event) ->\r\n\t\t# fit #image-field to be contained in #image-panel\r\n\t\t# 'box' means max acceptable size of #image-panel in #image-field.\r\n\t\tRENDERING_HEIGHT = 40\r\n\t\tIMAGEINFO_HEIGHT = 30\r\n\t\tcharacter = @characters[@questionIndex]\r\n\t\timageHeight = @queue.getResult(character + '.base').originalHeight\r\n\t\timageWidth = @queue.getResult(character + '.base').originalWidth\r\n\t\tboxWidth = $('#image-panel').width() * 0.9\r\n\t\tboxHeight = null\r\n\t\tif matchMedia('(min-width: 900px)').matches\r\n\t\t\tboxHeight = $('#image-panel').height() - RENDERING_HEIGHT - IMAGEINFO_HEIGHT\r\n\t\telse\r\n\t\t\tboxHeight = 800\r\n\t\tzoom = Math.min(boxWidth / imageWidth, boxHeight / imageHeight)\r\n\t\tfieldWidth = imageWidth * zoom\r\n\t\tfieldHeight = imageHeight * zoom\r\n\t\t$('#image-field').css\r\n\t\t\twidth: fieldWidth\r\n\t\t\theight: fieldHeight\r\n\t\t\t'-webkit-transform': 'none'\r\n\t\t\t'-moz-transform': 'none'\r\n\t\t\t'-o-transform': 'none'\r\n\t\t\ttransform: 'none'\r\n\r\n\t\tif matchMedia('(min-width: 900px)').matches\r\n\t\t\timageTop = ($('#image-panel').height() - fieldHeight) / 2\r\n\t\t\t$('#image-field').css\r\n\t\t\t\tposition: 'absolute'\r\n\t\t\t\ttop: imageTop\r\n\t\t\t\tleft: ($('#image-panel').width() - fieldWidth) / 2\r\n\t\t\t\tmargin: '0'\r\n\t\t\t$('#rendering').css\r\n\t\t\t\tposition: 'absolute'\r\n\t\t\t\tbottom: imageTop + fieldHeight\r\n\t\t\t$('#image-info').css\r\n\t\t\t\tposition: 'absolute'\r\n\t\t\t\ttop: imageTop + fieldHeight\r\n\t\telse\r\n\t\t\t$('#image-field').css\r\n\t\t\t\tposition: 'relative'\r\n\t\t\t\ttop: 0\r\n\t\t\t\tleft: 0\r\n\t\t\t\tmargin: '0 5%'\r\n\t\t\t$('#rendering').css\r\n\t\t\t\tposition: 'relative'\r\n\t\t\t\tbottom: 0\r\n\t\t\t$('#image-info').css\r\n\t\t\t\tposition: 'relative'\r\n\t\t\t\ttop: 0\r\n\r\n\t# move sliders of DOM from parameter value\r\n\tmoveSlider: (colorset, parameter, value) ->\r\n\t\t$parameter = $('.color-parameter-wrap[data-colorset=' + colorset + '][data-parameter=' + parameter + ']')\r\n\t\t$pinch = $parameter.find('.color-slider-pinch')\r\n\t\t$value = $parameter.find('.color-value')\r\n\t\t$pinch.css 'left', value * 100 + '%'\r\n\t\t$value.text Math.floor(percentageToRealValue(colorset, parameter, value))\r\n\r\n\tgoNext: ->\r\n\t\t@currentQuestion.quit =>\r\n\t\t\t@seenCharacters.push @characters[@questionIndex]\r\n\t\t\tif @seenCharacters.length is @availableCharacters.length\r\n\t\t\t\t@seenCharacters = []\r\n\t\t\tlocalStorage.seenCharacters = JSON.stringify @seenCharacters\r\n\r\n\t\t\t@questionIndex++\r\n\t\t\t@currentQuestion = new Question @, @characters[@questionIndex]\r\n\r\n\tselectTab: (tab) ->\r\n\t\t$('.colorset-sliders').hide()\r\n\t\t$('.tab').removeClass 'selected'\r\n\t\t$(\".colorset-sliders[data-colorset=#{tab}]\").show()\r\n\t\t$(\".tab[data-colorset=#{tab}]\").addClass 'selected'\r\n\r\n# set language\r\n\r\navailableLanguages = ['en', 'ja']\r\n\r\n$('html').classes().forEach (classname) ->\r\n\tif classname.startsWith 'lang-'\r\n\t\t$('html').removeClass classname\r\n\r\nlanguage = navigator.userLanguage or navigator.language;\r\nsetLanguage = null\r\navailableLanguages.forEach (availableLanguage) ->\r\n\tif language.startsWith availableLanguage\r\n\t\tsetLanguage = availableLanguage\r\n\r\nif not setLanguage\r\n\tsetLanguage = availableLanguages[0]\r\n\r\n$('html').addClass 'lang-' + setLanguage\r\n$('html').attr 'lang', setLanguage\r\n\r\n# kick start\r\n\r\ngame = new Game()\r\n"
  ]
}